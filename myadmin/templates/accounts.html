{% extends "home.html" %}

{% block header %}

{% endblock %}


{% block content %}

{% include "account/modal/create_modal.html" %}
{% include "account/modal/update_modal.html" %}

<div class="container" style="margin-top: 10px;">
    <div class="row">
        <div class="col s12 m12">
            <div class="card" style="padding:20px">
                {% if user.is_superuser %}
                <a class="waves-effect waves-light btn right modal-trigger" style="margin-bottom: 20px;" href="#modal1"><i
                        class="material-icons right">person_add</i>Шинэ хэрэглэгч үүсгэх</a>
                {% endif %}
                <table class="responsive-table" id="userTable">
                    <thead>
                        <tr>
                            <th>№</th>
                            <th>Хэрэглэгчийн нэр</th>
                            <th>Хэрэглэгчийн email</th>
                            <th>Хэрэглэгч удирдах эрх</th>
                            <th>Үйлдэл </th>
                        </tr>
                    </thead>

                    <tbody>
                        {% for user in userList%}
                        <tr>
                            <td>{{forloop.counter}}</td>
                            <td>{{user.username}}</td>
                            <td>{{user.email}}</td>
                            <td> {% if user.is_superuser %} Тийм {% else %} Үгүй {%endif%}
                            </td>
                            <td><a class="waves-effect waves-light btn modal-trigger" style="margin-bottom: 20px;" href="#modal2" onclick="edit('{{user.id}}')"><i
                                        class="material-icons right">edit</i>засварлах</a></td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var elems = document.querySelectorAll('.modal');
        var instances = M.Modal.init(elems, {});
    });
</script>
<script>
    // document.addEventListener('DOMContentLoaded', function() {
    //     var elems = document.querySelectorAll('.modal');
    //     var instances = M.Modal.init(elems, options);
    //   });
    $(document).ready(function () {
        // let table = $('#userTable').DataTable();
        //  = new DataTable('#userTable');

        var elems = document.querySelectorAll('.modal');
        var instances = M.Modal.init(elems, {
            dismissible: true, // Товчлуур эсвэл гадна дарж хаах боломжтой
            startingTop: '4%', // Эхлэх байршил
            endingTop: '10%' // Дуусах байршил
        });

    });

    function edit(id)
    {
        console.log(id);
        $('.modal').on('hidden.bs.modal', function () {
            $(this).removeData('bs.modal'); // remove data when modal is closed
        });
        $.get("/myadmin/account/" + id).then(e=>{
            // console.log(e);
            $("#updateAccountSection").html(e)
        }).catch(e=>console.log(e));
    }


</script>
{% endblock %}